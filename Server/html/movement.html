<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link type="text/css" href="/css/movement.css">
    </head>

    <body>
        <div class="grid-container">
                <div class="clickable-area forward" id="forwardArea">Vorwärts</div>
                <div class="clickable-area backward" id="backwardArea">Rückwärts</div>
                <div class="clickable-area left" id="leftArea">Links</div>
                <div class="clickable-area right" id="rightArea">Rechts</div>

            <div class="settings-icon" id="settingsIcon">⚙️</div>
        </div>

        
    
        <div class="speed-selector" id="speedSelector">
            <label for="speed">Geschwindigkeit:</label>
            <select name="speed" id="speed">
                <option value="slow">Langsam</option>
                <option value="medium">Mittel</option>
                <option value="fast">Schnell</option>
            </select>
            <button id="confirmSpeed">Bestätigen</button>
        </div>

       
        <div class="color-selector" id="colorSelector">
            <label for="color">Wähle eine Farbe:</label>
            <input type="color" id="color" name="color" value="#ff0000">
            <button id="confirmColor">Bestätigen</button>
        </div>

    </body>

    <!-- 
    <script src="../js/movement.js"></script>
     -->
<style>


.color-selector {
    display: none; /* Initially hidden, can be shown like the speed selector */
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border: 1px solid black;
    text-align: center;
}

.color-selector label,
.color-selector input,
.color-selector button {
    display: block;
    margin: 10px auto;
    width: 80%;
}



    .right,
.left {
    background-color: orange;
}

.forward,
.backward {
    background-color: rgb(86, 198, 236);
}

.right {
    grid-area: r;
}

.left {
    grid-area: l;

}


.forward {
    grid-area: f;
}

.backward {
    grid-area: b;
}

div{
    border-radius: 10px;
    display: flex;
    flex-direction: row;
    justify-content: center;

}

.grid-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    grid-template-areas: '. f .' 
                         'l b r'
                         '. . .';
    grid-gap: 10px;
    height: 100vh;
}

.settings-icon {
    cursor: pointer;
    width: 20px;
    height: 20px;
    
}
.settings-icon:hover{
    transform: rotate(45deg);
}

.speed-selector {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border: 1px solid black;
    text-align: center;
}

.speed-selector label,
.speed-selector button {
    display: block;
    margin: 10px auto; 
    width: 80%; 
    height: 70px; 
    font-size: 20px;
}

</style>


<script>
document.addEventListener('DOMContentLoaded', function () {
    const leftArea = document.querySelector('.left');
    const rightArea = document.querySelector('.right');
    const forwardArea = document.querySelector('.forward');
    const backwardArea = document.querySelector('.backward');
    const settingsIcon = document.getElementById('settingsIcon');
    const speedSelector = document.getElementById('speedSelector');
    const confirmSpeedBtn = document.getElementById('confirmSpeed');
    const speedSelect = document.getElementById('speed');
    const colorSelector = document.getElementById('colorSelector');
    const confirmColorBtn = document.getElementById('confirmColor');
    const colorInput = document.getElementById('color');

    settingsIcon.addEventListener('click', function () {
        speedSelector.style.display = 'block';
    });

    confirmSpeedBtn.addEventListener('click', function () {
        let selectedSpeed = speedSelect.value;
        console.log('Selected Speed:', selectedSpeed);
        speedSelector.style.display = 'none';
    });



    settingsIcon.addEventListener('click', function () {
        colorSelector.style.display = 'block';
    });

    // Handle color confirmation
    confirmColorBtn.addEventListener('click', function () {
        let selectedColor = colorInput.value;
        console.log('Selected Color:', selectedColor);
        colorSelector.style.display = 'none';

        selectedColor = selectedColor.replace('#', '');

        const r = parseInt(selectedColor.slice(0, 2), 16);
        const g = parseInt(selectedColor.slice(2, 4), 16);
        const b = parseInt(selectedColor.slice(4, 6), 16);

        rgb = r+":"+g+":"+b;
        

        const command = {
            typ: '8',
            command: rgb
        };
        
        
        sendColor(command);
    });

    
    function sendColor(command) {
        
        fetchCommand('/sendColor', command);
    }
    

    

    function fetchCommand(route,command)
    {
        
        fetch(route, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(command)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Server response:', data);
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }


    

    function handleMouseOver(direction) {


        console.log('Mouse Over!');

        
        const command = {
            typ: direction,
            command: direction
        };
        

        sendMovement(command);

    }

    function handleMouseOut() {

        console.log('Mouse Out!');

        
        const command = {
            typ: -1,
            command: -1
        };


        sendMovement(command);
    }
    



    leftArea.addEventListener('mouseover', () => {
        handleMouseOver(3);
    });
    rightArea.addEventListener('mouseover', () => {
        handleMouseOver(1);
    });
    forwardArea.addEventListener('mouseover', () => {
        handleMouseOver(0);
    });
    backwardArea.addEventListener('mouseover', () => {
        handleMouseOver(2);
    });


    leftArea.addEventListener('mouseout', () => {
        handleMouseOut();
    });
    rightArea.addEventListener('mouseout', () => {
        handleMouseOut();
    });
    forwardArea.addEventListener('mouseout', () => {
        handleMouseOut();
    });
    backwardArea.addEventListener('mouseout', () => {
        handleMouseOut();
    });


    


    function sendMovement(command) {


        fetchCommand('/sendMovement',command)

        /*
        fetch('/sendMovement', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(command)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Server response:', data);
        })
        .catch(error => {
            console.error('Error:', error);
        });

    */
   
    }
    

    confirmSpeedBtn.addEventListener('click', function () {

        let selectedSpeed = speedSelect.value;
        console.log('Selected Speed:', selectedSpeed);
        speedSelector.style.display = 'none';

        if(selectedSpeed == "medium")
        {
            selectedSpeed = '6';
        }
        else if(selectedSpeed == 'slow')
        {
            selectedSpeed = '5';
        }
        else if(selectedSpeed == 'fast')
        {
            selectedSpeed = '7';
        }
        

        const command = {
            command: selectedSpeed,
            typ: selectedSpeed
        };
        
        sendSpeed(command);
});

    function sendSpeed(command) {
        
        fetchCommand('/sendSpeed', command);

        /*
        fetch('/sendSpeed', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(command)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Server response:', data);
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
    */
}
    
});
     </script> 
</html> 



