<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link type="text/css" href="/css/movement.css">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
      body {
          font-family: Arial, sans-serif;
          margin: 0;
          padding: 0;
          display: flex;
          min-height: 100vh;
          flex-direction: column;
      }
      header {
          background-color: #333;
          color: #fff;
          padding: 10px 20px;
          text-align: center;
      }
      main {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          position: relative; 
      }
      /* Add additional CSS here... */
    </style>

</head>
<body>
    <header>
        <h1>MBot-Data</h1>
    </header>
<main>
  <select id="dataSelector" onchange="fetchAndDisplayData()">
    <option value="collection1">Collection 1</option>
    <option value="collection2">Collection 2</option>
    <!-- Add more options based on your collections -->
</select>
<div id="chart_div"></div>
</main>

<footer>
    <p>&copy; 2024 Remote Control. All rights reserved.</p>
</footer>
</body>

<script>

// Load the Visualization API and the corechart package.
google.charts.load('current', {'packages':['corechart']});

// Set a callback to run when the Google Visualization API is loaded.
google.charts.setOnLoadCallback(fetchAndDisplayData);

function drawChart(dataArray) {
    // Create the data table.
    var data = new google.visualization.DataTable();
    data.addColumn('string', 'X'); // Modify according to your data keys
    data.addColumn('number', 'Y'); // Modify according to your data keys

    // Convert data to Google Charts compatible format
    data.addRows(dataArray.map(item => [item.xValue, item.yValue]));

    // Set chart options
    var options = {
        title: 'Live Data Display',
        hAxis: {title: 'X Axis Label'},
        vAxis: {title: 'Y Axis Label'},
        legend: 'none'
    };

    // Instantiate and draw our chart, passing in some options.
    var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
    chart.draw(data, options);
}

function fetchAndDisplayData() {
    const collection = document.getElementById('dataSelector').value;
    fetch(`/data?collection=${collection}`)
        .then(response => response.json())
        .then(data => {
            drawChart(data);
        })
        .catch(error => console.error('Error fetching data:', error));
}
  </script>
</html>